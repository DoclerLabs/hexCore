sudo: required
dist: trusty

language: haxe

# haxe versions : http://haxe.org/website-content/downloads/versions.json
haxe:
  - "3.4.7"
  - development

matrix:
  allow_failures:
  - haxe: development
    
before_install:
  - echo $TRAVIS_BRANCH
  - export DEPENDENCIES_BRANCH=$TRAVIS_BRANCH
  - echo $TRAVIS_TAG
  - if [[ "$TRAVIS_TAG" != "" ]]; then export DEPENDENCIES_BRANCH=$TRAVIS_TAG; fi
  - echo $DEPENDENCIES_BRANCH

install:
  - haxelib newrepo
  - haxelib install travix --always
  - export BRANCH_REF=$DEPENDENCIES_BRANCH
# hexCore
  - haxelib dev hexcore .
  - haxelib install haxelib.json --always
# hexLog
  - if [[ $( git ls-remote https://github.com/DoclerLabs/hexLog.git $DEPENDENCIES_BRANCH --heads | wc -l ) == "0" ]]; then export DEPENDENCIES_BRANCH=master; else export DEPENDENCIES_BRANCH=$BRANCH_REF; fi
  - echo Checking out $DEPENDENCIES_BRANCH
  - git clone --recursive -b $DEPENDENCIES_BRANCH https://github.com/DoclerLabs/hexLog.git ./hexlog
  - haxelib dev hexlog ./hexlog
# hexUnit
  - if [[ $( git ls-remote https://github.com/DoclerLabs/hexUnit.git $DEPENDENCIES_BRANCH --heads | wc -l ) == "0" ]]; then export DEPENDENCIES_BRANCH=master; else export DEPENDENCIES_BRANCH=$BRANCH_REF; fi
  - echo Checking out $DEPENDENCIES_BRANCH
  - git clone --recursive -b $DEPENDENCIES_BRANCH https://github.com/DoclerLabs/hexUnit.git ./hexunit
  - haxelib dev hexunit ./hexunit
#
  - haxelib path hexcore

script:
  - haxelib run travix php
  - haxelib run travix neko
  - haxelib run travix js
  - haxelib run travix flash
  
notifications:
  email:
    recipients:
      - francis_bourre@me.com
      - peterphonix@gmail.com
      - laurent@geturl.net
